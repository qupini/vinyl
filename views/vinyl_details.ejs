<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.jsdelivr.net/npm/text-encoding@0.7.0/lib/encoding.js"></script>
    <!-- Остальная часть head -->
    <title><%= vinyl.vinyl_title %></title>
    <style>
        a {
            font-family: 'Donpo';
            text-align: center;
            margin-top: 80px;
            color: rgb(0, 0, 0);
            text-decoration: none;
        }
        
        @media print {
            img {
                display: block !important;
                width: 100%;
            }
            
            body * {
                display: none;
            }
        }
    </style>
</head>
<body>
    <h1><a href="/vinyl.html" >Виниловые пластинки</a></h1>
    <h1><%= vinyl.vinyl_title %></h1>
    <div>Год выпуска: <%= vinyl.vinyl_releaseyear %></div>
    <!-- и так далее для всех данных о пластинке -->
    <ul id="tracklist">
        <% tracks.forEach(track => { %>
            <li><%= track.track_title %></li>
        <% }); %>
    </ul>
    <img hidden src="<%= vinyl.vinyl_qr %>" alt="QR Code" />
    <button id="printQRCodeButton">Печать QR-кода</button>
    <button id="sovsearch">Поиск по сайту sovmusic.ru</button>

    <script>
    document.getElementById('printQRCodeButton').addEventListener('click', function() {
        window.print();
    });


    


    document.getElementById('sovsearch').addEventListener('click', function() {
    var vinylTitle = '<%= vinyl.vinyl_title %>';

    fetch('/encode', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ text: vinylTitle })
    })
    .then(response => response.json())
    .then(data => {
        var searchUrl = 'http://www.sovmusic.ru/result.php?type=simple&searchterm=' + data.encoded + '&searchtype=name';
        window.open(searchUrl, '_blank');
    })
    .catch(error => console.error('Error:', error));
});

</script>

</body>
</html>